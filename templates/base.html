<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Student Attendance System{% endblock %}</title>

    <script src="{{ url_for('static', filename='js/tailwindcss.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/qrcode.min.js') }}"></script>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/sweetalert2.min.css') }}">
    <script src="{{ url_for('static', filename='js/sweetalert2.min.js') }}"></script>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out;
        }

        .animate-slideIn {
            animation: slideIn 0.4s ease-out;
        }

        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5568d3 0%, #6a4193 100%);
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .main-container {
            display: flex;
            flex: 1 0 auto;
            overflow: hidden;
        }

        .sidebar {
            width: 13rem;
            flex-shrink: 0;
            overflow-y: auto;
        }

        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .content-scroll {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
        }

        .footer {
            flex-shrink: 0;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            filter: invert(1);
            margin-right: 12px;
        }
    </style>

    {% block extra_css %}{% endblock %}
</head>

<body class="bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 font-sans">

    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg">
        <div class="px-6 py-4">
            <h4 class="text-base font-medium tracking-wide">
                Student Attendance System
            </h4>
        </div>
    </div>

    <div class="main-container">

        {# Only show sidebar when user is logged in AND not on login/qr scanner pages #}
        {% if session.user_id and request.endpoint not in ['login', 'qr_scanner'] %}
        <div class="sidebar bg-gradient-to-b from-cyan-500 to-blue-600 shadow-xl">
            <nav class="py-6 space-y-2">

                <a href="{{ url_for('user_management') }}"
                   class="flex items-center mx-3 px-5 py-3 text-white font-semibold text-sm tracking-wide rounded-lg 
                   transition-all duration-200 hover:bg-white/25 hover:translate-x-1 hover:shadow-lg
                   {% if request.endpoint == 'user_management' %}bg-white/30 shadow-lg{% endif %}">
                    <img src="{{ url_for('static', filename='icons/usermanagement.png') }}" alt="User Management" class="nav-icon">
                    USER MANAGEMENT
                </a>

                <a href="{{ url_for('student_management') }}"
                   class="flex items-center mx-3 px-5 py-3 text-white font-semibold text-sm tracking-wide rounded-lg 
                   transition-all duration-200 hover:bg-white/25 hover:translate-x-1 hover:shadow-lg
                   {% if request.endpoint == 'student_management' %}bg-white/30 shadow-lg{% endif %}">
                    <img src="{{ url_for('static', filename='icons/studentmanagement.png') }}" alt="Student Management" class="nav-icon">
                    STUDENT MANAGEMENT
                </a>

                <a href="{{ url_for('view_attendance') }}"
                   class="flex items-center mx-3 px-5 py-3 text-white font-semibold text-sm tracking-wide rounded-lg 
                   transition-all duration-200 hover:bg-white/25 hover:translate-x-1 hover:shadow-lg
                   {% if request.endpoint == 'view_attendance' %}bg-white/30 shadow-lg{% endif %}">
                    <img src="{{ url_for('static', filename='icons/attendance.png') }}" alt="View Attendance" class="nav-icon">
                    VIEW ATTENDANCE
                </a>

                <a href="{{ url_for('logout') }}"
                   class="flex items-center mx-3 px-5 py-3 text-white font-semibold text-sm tracking-wide rounded-lg 
                   transition-all duration-200 hover:bg-red-500/90 hover:translate-x-1 hover:shadow-lg">
                    <img src="{{ url_for('static', filename='icons/logout.png') }}" alt="Logout" class="nav-icon">
                    LOGOUT
                </a>

            </nav>
        </div>
        {% endif %}

        <div class="content-area">
            <div class="content-scroll">
                <div class="max-w-7xl mx-auto">
                    {% block content %}{% endblock %}
                </div>
            </div>
        </div>

    </div>

    <footer class="footer bg-white border-t border-gray-200 text-center py-4">
        <p class="text-gray-600 text-sm">
            Copyright Â© Lapis, Ranz Junnel 2025
        </p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                Swal.fire({
                    icon: '{{ category|default("info") }}',
                    title: '{{ message }}',
                    text: '',
                    timer: 2000,
                    showConfirmButton: false,
                    toast: true,
                    position: 'top-end'
                });
                {% endfor %}
            {% endif %}
            {% endwith %}

        });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>
